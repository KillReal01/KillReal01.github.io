<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1280">
    <title>Инфраструктура</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/infrastructure.css">
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <a href="index.html">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                </svg>
                <h1>Кибербезопасность</h1>
            </a>
        </div>
        <nav class="nav-links">
            <a href="#admin" class="admin-link">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                Админ-панель
            </a>
            <a href="#infrastructure">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"/>
                </svg>
                Инфраструктура
            </a>
            <a href="risks.html">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                </svg>
                Риски
            </a>
            <a href="#strategy">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
                Стратегия
            </a>
            <a href="#reports">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                Отчеты
            </a>
            <a href="#vendors">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                </svg>
                Поставщики
            </a>
        </nav>
    </aside>

    <div class="map-container">
        <div class="map-wrapper">
            <svg class="map" id="map" viewBox="0 0 800 600">
                <!-- Сервер с блоком активов -->
                <g class="node server" transform="translate(400,100)">
                    <rect x="-30" y="-40" width="60" height="80" rx="5" fill="#4a90e2"/>
                    <rect x="-25" y="-35" width="50" height="10" fill="#ffffff" opacity="0.3"/>
                    <rect x="-25" y="-20" width="50" height="10" fill="#ffffff" opacity="0.3"/>
                    <text class="node-label" x="0" y="-50" text-anchor="middle">Основной сервер</text>
                </g>

                <!-- Блок активов отдельно -->
                <g class="assets-container" transform="translate(470,100)">
                    <rect x="-30" y="-20" width="60" height="40" rx="5" fill="#ffd700"/>
                    <text x="0" y="5" text-anchor="middle" fill="#333">Активы</text>
                    
                    <!-- Раскрывающийся список -->
                    <g class="assets-list">
                        <rect x="-50" y="25" width="100" height="100" rx="5" fill="white" stroke="#ccc"/>
                        <text x="-40" y="45">Актив 1</text>
                        <text x="-40" y="65">Актив 2</text>
                        <text x="-40" y="85">Актив 3</text>
                        <text x="-40" y="105">Актив 4</text>
                    </g>
                </g>

                <!-- Коммутатор -->
                <g class="node switch" transform="translate(400,250)">
                    <rect x="-40" y="-15" width="80" height="30" rx="5" fill="#50c878"/>
                    <circle cx="-30" cy="0" r="3" fill="#ffffff"/>
                    <circle cx="-15" cy="0" r="3" fill="#ffffff"/>
                    <circle cx="0" cy="0" r="3" fill="#ffffff"/>
                    <circle cx="15" cy="0" r="3" fill="#ffffff"/>
                    <circle cx="30" cy="0" r="3" fill="#ffffff"/>
                    <text class="node-label" x="0" y="-25" text-anchor="middle">Коммутатор</text>
                </g>

                <!-- Хосты -->
                <g class="node host" transform="translate(200,400)">
                    <rect x="-25" y="-30" width="50" height="60" rx="5" fill="#ff7f50"/>
                    <rect x="-20" y="-25" width="40" height="25" fill="#ffffff" opacity="0.3"/>
                    <text class="node-label" x="0" y="50" text-anchor="middle">Хост 1</text>
                </g>

                <g class="node host" transform="translate(400,400)">
                    <rect x="-25" y="-30" width="50" height="60" rx="5" fill="#ff7f50"/>
                    <rect x="-20" y="-25" width="40" height="25" fill="#ffffff" opacity="0.3"/>
                    <text class="node-label" x="0" y="50" text-anchor="middle">Хост 2</text>
                </g>

                <g class="node host" transform="translate(600,400)">
                    <rect x="-25" y="-30" width="50" height="60" rx="5" fill="#ff7f50"/>
                    <rect x="-20" y="-25" width="40" height="25" fill="#ffffff" opacity="0.3"/>
                    <text class="node-label" x="0" y="50" text-anchor="middle">Хост 3</text>
                </g>

                <!-- Связи -->
                <g class="connections">
                    <line x1="400" y1="140" x2="400" y2="235" stroke="#666" stroke-width="2"/>
                    <line x1="400" y1="265" x2="200" y2="370" stroke="#666" stroke-width="2"/>
                    <line x1="400" y1="265" x2="400" y2="370" stroke="#666" stroke-width="2"/>
                    <line x1="400" y1="265" x2="600" y2="370" stroke="#666" stroke-width="2"/>
                </g>
            </svg>
        </div>
        <div class="controls">
            <button class="control-btn" onclick="zoom(1.1)">+</button>
            <button class="control-btn" onclick="zoom(0.9)">-</button>
        </div>
    </div>

    <div class="info-panel" id="infoPanel">
        <button class="close-btn" onclick="closeInfo()">×</button>
        <h3>Активы</h3>
        <ul>
            <li>Компьютер 1</li>
            <li>Компьютер 2</li>
            <li>Компьютер 3</li>
        </ul>
    </div>

    <script>
        const map = document.getElementById('map');
        const mapWrapper = document.querySelector('.map-wrapper');
        let isDragging = false;
        let currentX;
        let currentY;
        let initialX;
        let initialY;
        let xOffset = 0;
        let yOffset = 0;
        let scale = 1;

        function setTransform() {
            map.style.transform = `translate(${currentX}px, ${currentY}px) scale(${scale})`;
        }

        function dragStart(e) {
            if (e.type === "touchstart") {
                initialX = e.touches[0].clientX - xOffset;
                initialY = e.touches[0].clientY - yOffset;
            } else {
                initialX = e.clientX - xOffset;
                initialY = e.clientY - yOffset;
            }
            isDragging = true;
        }

        function drag(e) {
            if (isDragging) {
                e.preventDefault();

                if (e.type === "touchmove") {
                    currentX = e.touches[0].clientX - initialX;
                    currentY = e.touches[0].clientY - initialY;
                } else {
                    currentX = e.clientX - initialX;
                    currentY = e.clientY - initialY;
                }

                xOffset = currentX;
                yOffset = currentY;

                setTransform();
            }
        }

        function dragEnd() {
            isDragging = false;
        }

        function zoom(factor) {
            scale *= factor;
            scale = Math.min(Math.max(0.5, scale), 3);
            setTransform();
        }

        // Обработчики для десктопа
        mapWrapper.addEventListener('mousedown', dragStart);
        document.addEventListener('mousemove', drag);
        document.addEventListener('mouseup', dragEnd);

        // Обработчики для мобильных устройств
        mapWrapper.addEventListener('touchstart', dragStart);
        document.addEventListener('touchmove', drag);
        document.addEventListener('touchend', dragEnd);

        // Обработчик для блока активов
        const assetsContainer = document.querySelector('.assets-container');
        const assetsList = document.querySelector('.assets-list');
        
        assetsContainer.addEventListener('click', (e) => {
            e.stopPropagation(); // Предотвращаем всплытие события
            assetsList.classList.toggle('active');
        });

        // Закрываем список при клике вне его
        document.addEventListener('click', (e) => {
            if (!assetsContainer.contains(e.target)) {
                assetsList.classList.remove('active');
            }
        });
    </script>
</body>
</html>
