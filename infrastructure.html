<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1280">
    <title>Инфраструктура</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/infrastructure.css">
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <a href="index.html">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                </svg>
                <h1>GR3B0B3M4S3N</h1>
            </a>
        </div>
        <nav class="nav-links">
            <a href="admin.html" class="admin-link">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                Админ-панель
            </a>
            <a href="infrastructure.html">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"/>
                </svg>
                Инфраструктура
            </a>
            <a href="risks.html">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                </svg>
                Риски
            </a>
            <a href="strategy.html">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
                Стратегия
            </a>
            <a href="vendor.html">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                </svg>
                Поставщик
            </a>
        </nav>
    </aside>

    <div class="map-container">
        <div class="map-wrapper">
            <div class="controls">
                <button class="control-btn" onclick="zoom(1.1)">+</button>
                <button class="control-btn" onclick="zoom(0.9)">-</button>
            </div>
            <svg class="map" id="map" viewBox="0 0 1000 800">
                <!-- Определения градиентов -->
                <defs>
                    <linearGradient id="serverGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#5a9ff2"/>
                        <stop offset="100%" style="stop-color:#4a90e2"/>
                    </linearGradient>
                    <linearGradient id="switchGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#60d888"/>
                        <stop offset="100%" style="stop-color:#50c878"/>
                    </linearGradient>
                    <linearGradient id="monitorGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#3f4650"/>
                        <stop offset="100%" style="stop-color:#2f3640"/>
                    </linearGradient>
                    <linearGradient id="firewallGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#ff7675"/>
                        <stop offset="100%" style="stop-color:#d63031"/>
                    </linearGradient>
                    <linearGradient id="nasGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#a29bfe"/>
                        <stop offset="100%" style="stop-color:#6c5ce7"/>
                    </linearGradient>
                    <filter id="shadow">
                        <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.3"/>
                    </filter>
                </defs>

                <!-- Перемещаем связи в начало, чтобы они были на заднем плане -->
                <g class="connections">
                    <!-- Интернет - Файрвол -->
                    <line x1="500" y1="90" x2="500" y2="125" stroke="#2d3436" stroke-width="3"/>
                    
                    <!-- Файрвол - Коммутатор ядра -->
                    <line x1="500" y1="175" x2="500" y2="275" stroke="#2d3436" stroke-width="3"/>
                    
                    <!-- Коммутатор ядра - Серверы -->
                    <line x1="500" y1="325" x2="300" y2="400" stroke="#2d3436" stroke-width="3"/>
                    <line x1="500" y1="325" x2="700" y2="400" stroke="#2d3436" stroke-width="3"/>
                    
                    <!-- Коммутатор ядра - NAS -->
                    <line x1="500" y1="325" x2="900" y2="400" stroke="#2d3436" stroke-width="3"/>
                    
                    <!-- Коммутатор ядра - Коммутаторы доступа -->
                    <line x1="500" y1="325" x2="200" y2="525" stroke="#2d3436" stroke-width="3"/>
                    <line x1="500" y1="325" x2="500" y2="525" stroke="#2d3436" stroke-width="3"/>
                    <line x1="500" y1="325" x2="800" y2="525" stroke="#2d3436" stroke-width="3"/>
                    
                    <!-- Коммутаторы доступа - Хосты -->
                    <line x1="200" y1="575" x2="150" y2="650" stroke="#2d3436" stroke-width="3"/>
                    <line x1="200" y1="575" x2="250" y2="650" stroke="#2d3436" stroke-width="3"/>
                    
                    <line x1="500" y1="575" x2="450" y2="650" stroke="#2d3436" stroke-width="3"/>
                    <line x1="500" y1="575" x2="550" y2="650" stroke="#2d3436" stroke-width="3"/>
                    
                    <line x1="800" y1="575" x2="750" y2="650" stroke="#2d3436" stroke-width="3"/>
                    <line x1="800" y1="575" x2="850" y2="650" stroke="#2d3436" stroke-width="3"/>
                </g>

                <!-- Остальные элементы инфраструктуры -->
                <!-- Интернет (облако) -->
                <g class="node cloud" transform="translate(500,50)">
                    <path d="M-40,-20 C-40,-33 -25,-45 -10,-45 C-8,-60 10,-60 20,-50 C30,-60 50,-60 60,-45 C75,-45 85,-30 80,-20 C85,-10 85,0 80,10 C85,20 75,30 60,30 C55,40 40,40 30,35 C20,40 0,40 -10,30 C-25,30 -40,20 -40,10 C-45,0 -45,-10 -40,-20" 
                          fill="#B2BEC3" filter="url(#shadow)"/>
                    <text class="node-label" x="0" y="-60" text-anchor="middle">Интернет</text>
                </g>

                <!-- Файрвол -->
                <g class="node firewall" transform="translate(500,150)">
                    <rect x="-30" y="-25" width="60" height="50" rx="5" fill="url(#firewallGradient)" filter="url(#shadow)"/>
                    <path d="M-20,-15 L20,-15 M-20,0 L20,0 M-20,15 L20,15" stroke="white" stroke-width="3"/>
                    <text class="node-label" x="0" y="-35" text-anchor="middle">Файрвол</text>
                </g>

                <!-- Основной коммутатор уровня ядра -->
                <g class="node switch" transform="translate(500,300)">
                    <rect x="-40" y="-15" width="80" height="30" rx="5" fill="url(#switchGradient)" filter="url(#shadow)"/>
                    <rect x="-35" y="-10" width="70" height="20" fill="#ffffff" opacity="0.1"/>
                    <circle cx="-25" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="-15" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="-5" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="5" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="15" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="25" cy="0" r="2" fill="#00ff00"/>
                    <text class="node-label" x="0" y="-25" text-anchor="middle">Коммутатор ядра</text>
                </g>

                <!-- Основной и резервный серверы -->
                <g transform="translate(500,400)">
                    <g class="node server" transform="translate(-200,0)">
                        <rect x="-30" y="-40" width="60" height="80" rx="5" fill="url(#serverGradient)" filter="url(#shadow)"/>
                        <path d="M-25,-35 h50 v10 h-50 z M-25,-20 h50 v10 h-50 z M-25,-5 h50 v10 h-50 z" fill="#ffffff" opacity="0.3"/>
                        <rect x="-28" y="15" width="56" height="5" fill="#ffffff" opacity="0.2"/>
                        <rect x="-28" y="25" width="56" height="5" fill="#ffffff" opacity="0.2"/>
                        <text class="node-label" x="0" y="-50" text-anchor="middle">Основной сервер</text>
                    </g>
                    <g class="node server" transform="translate(200,0)">
                        <rect x="-30" y="-40" width="60" height="80" rx="5" fill="url(#serverGradient)" filter="url(#shadow)"/>
                        <path d="M-25,-35 h50 v10 h-50 z M-25,-20 h50 v10 h-50 z M-25,-5 h50 v10 h-50 z" fill="#ffffff" opacity="0.3"/>
                        <rect x="-28" y="15" width="56" height="5" fill="#ffffff" opacity="0.2"/>
                        <rect x="-28" y="25" width="56" height="5" fill="#ffffff" opacity="0.2"/>
                        <text class="node-label" x="0" y="-50" text-anchor="middle">Резервный сервер</text>
                    </g>
                </g>

                <!-- NAS хранилище - перемещаем правее -->
                <g class="node nas" transform="translate(900,400)">
                    <rect x="-40" y="-30" width="80" height="60" rx="5" fill="url(#nasGradient)" filter="url(#shadow)"/>
                    <rect x="-35" y="-25" width="70" height="10" fill="#ffffff" opacity="0.2"/>
                    <rect x="-35" y="-10" width="70" height="10" fill="#ffffff" opacity="0.2"/>
                    <rect x="-35" y="5" width="70" height="10" fill="#ffffff" opacity="0.2"/>
                    <text class="node-label" x="0" y="-40" text-anchor="middle">NAS</text>
                </g>

                <!-- Коммутаторы доступа -->
                <g class="node switch" transform="translate(200,550)">
                    <rect x="-40" y="-15" width="80" height="30" rx="5" fill="url(#switchGradient)" filter="url(#shadow)"/>
                    <rect x="-35" y="-10" width="70" height="20" fill="#ffffff" opacity="0.1"/>
                    <circle cx="-25" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="-15" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="-5" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="5" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="15" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="25" cy="0" r="2" fill="#00ff00"/>
                    <text class="node-label" x="0" y="-25" text-anchor="middle">VLAN 10</text>
                </g>

                <g class="node switch" transform="translate(500,550)">
                    <rect x="-40" y="-15" width="80" height="30" rx="5" fill="url(#switchGradient)" filter="url(#shadow)"/>
                    <rect x="-35" y="-10" width="70" height="20" fill="#ffffff" opacity="0.1"/>
                    <circle cx="-25" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="-15" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="-5" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="5" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="15" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="25" cy="0" r="2" fill="#00ff00"/>
                    <text class="node-label" x="0" y="-25" text-anchor="middle">VLAN 20</text>
                </g>

                <g class="node switch" transform="translate(800,550)">
                    <rect x="-40" y="-15" width="80" height="30" rx="5" fill="url(#switchGradient)" filter="url(#shadow)"/>
                    <rect x="-35" y="-10" width="70" height="20" fill="#ffffff" opacity="0.1"/>
                    <circle cx="-25" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="-15" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="-5" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="5" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="15" cy="0" r="2" fill="#00ff00"/>
                    <circle cx="25" cy="0" r="2" fill="#00ff00"/>
                    <text class="node-label" x="0" y="-25" text-anchor="middle">VLAN 30</text>
                </g>

                <!-- Рабочие станции -->
                <g transform="translate(0,650)">
                    <g class="node host" transform="translate(150,0)">
                        <!-- Монитор -->
                        <rect x="-25" y="-35" width="50" height="40" rx="2" fill="url(#monitorGradient)" filter="url(#shadow)"/>
                        <rect x="-22" y="-32" width="44" height="34" fill="#74b9ff" filter="url(#shadow)"/>
                        <rect x="-5" y="5" width="10" height="5" fill="#2f3640"/>
                        <rect x="-15" y="10" width="30" height="2" fill="#2f3640"/>
                        <!-- Системный блок -->
                        <rect x="-35" y="-25" width="15" height="35" rx="2" fill="#7f8fa6"/>
                        <circle cx="-27.5" cy="-15" r="2" fill="#00a8ff"/>
                        <rect x="-32" y="-5" width="9" height="2" fill="#2f3640"/>
                        <rect x="-32" y="0" width="9" height="2" fill="#2f3640"/>
                        <text class="node-label" x="0" y="50" text-anchor="middle">Хост 1</text>
                    </g>
                    <g class="node host" transform="translate(250,0)">
                        <!-- Монитор -->
                        <rect x="-25" y="-35" width="50" height="40" rx="2" fill="url(#monitorGradient)" filter="url(#shadow)"/>
                        <rect x="-22" y="-32" width="44" height="34" fill="#74b9ff" filter="url(#shadow)"/>
                        <rect x="-5" y="5" width="10" height="5" fill="#2f3640"/>
                        <rect x="-15" y="10" width="30" height="2" fill="#2f3640"/>
                        <!-- Системный блок -->
                        <rect x="-35" y="-25" width="15" height="35" rx="2" fill="#7f8fa6"/>
                        <circle cx="-27.5" cy="-15" r="2" fill="#00a8ff"/>
                        <rect x="-32" y="-5" width="9" height="2" fill="#2f3640"/>
                        <rect x="-32" y="0" width="9" height="2" fill="#2f3640"/>
                        <text class="node-label" x="0" y="50" text-anchor="middle">Хост 2</text>
                    </g>
                </g>

                <!-- Вторая группа хостов -->
                <g transform="translate(0,650)">
                    <g class="node host" transform="translate(450,0)">
                        <!-- Монитор -->
                        <rect x="-25" y="-35" width="50" height="40" rx="2" fill="url(#monitorGradient)" filter="url(#shadow)"/>
                        <rect x="-22" y="-32" width="44" height="34" fill="#74b9ff" filter="url(#shadow)"/>
                        <rect x="-5" y="5" width="10" height="5" fill="#2f3640"/>
                        <rect x="-15" y="10" width="30" height="2" fill="#2f3640"/>
                        <!-- Системный блок -->
                        <rect x="-35" y="-25" width="15" height="35" rx="2" fill="#7f8fa6"/>
                        <circle cx="-27.5" cy="-15" r="2" fill="#00a8ff"/>
                        <rect x="-32" y="-5" width="9" height="2" fill="#2f3640"/>
                        <rect x="-32" y="0" width="9" height="2" fill="#2f3640"/>
                        <text class="node-label" x="0" y="50" text-anchor="middle">Хост 3</text>
                    </g>
                    <g class="node host" transform="translate(550,0)">
                        <!-- Монитор -->
                        <rect x="-25" y="-35" width="50" height="40" rx="2" fill="url(#monitorGradient)" filter="url(#shadow)"/>
                        <rect x="-22" y="-32" width="44" height="34" fill="#74b9ff" filter="url(#shadow)"/>
                        <rect x="-5" y="5" width="10" height="5" fill="#2f3640"/>
                        <rect x="-15" y="10" width="30" height="2" fill="#2f3640"/>
                        <!-- Системный блок -->
                        <rect x="-35" y="-25" width="15" height="35" rx="2" fill="#7f8fa6"/>
                        <circle cx="-27.5" cy="-15" r="2" fill="#00a8ff"/>
                        <rect x="-32" y="-5" width="9" height="2" fill="#2f3640"/>
                        <rect x="-32" y="0" width="9" height="2" fill="#2f3640"/>
                        <text class="node-label" x="0" y="50" text-anchor="middle">Хост 4</text>
                    </g>
                </g>

                <!-- Третья группа хостов -->
                <g transform="translate(0,650)">
                    <g class="node host" transform="translate(750,0)">
                        <!-- Монитор -->
                        <rect x="-25" y="-35" width="50" height="40" rx="2" fill="url(#monitorGradient)" filter="url(#shadow)"/>
                        <rect x="-22" y="-32" width="44" height="34" fill="#74b9ff" filter="url(#shadow)"/>
                        <rect x="-5" y="5" width="10" height="5" fill="#2f3640"/>
                        <rect x="-15" y="10" width="30" height="2" fill="#2f3640"/>
                        <!-- Системный блок -->
                        <rect x="-35" y="-25" width="15" height="35" rx="2" fill="#7f8fa6"/>
                        <circle cx="-27.5" cy="-15" r="2" fill="#00a8ff"/>
                        <rect x="-32" y="-5" width="9" height="2" fill="#2f3640"/>
                        <rect x="-32" y="0" width="9" height="2" fill="#2f3640"/>
                        <text class="node-label" x="0" y="50" text-anchor="middle">Хост 5</text>
                    </g>
                    <g class="node host" transform="translate(850,0)">
                        <!-- Монитор -->
                        <rect x="-25" y="-35" width="50" height="40" rx="2" fill="url(#monitorGradient)" filter="url(#shadow)"/>
                        <rect x="-22" y="-32" width="44" height="34" fill="#74b9ff" filter="url(#shadow)"/>
                        <rect x="-5" y="5" width="10" height="5" fill="#2f3640"/>
                        <rect x="-15" y="10" width="30" height="2" fill="#2f3640"/>
                        <!-- Системный блок -->
                        <rect x="-35" y="-25" width="15" height="35" rx="2" fill="#7f8fa6"/>
                        <circle cx="-27.5" cy="-15" r="2" fill="#00a8ff"/>
                        <rect x="-32" y="-5" width="9" height="2" fill="#2f3640"/>
                        <rect x="-32" y="0" width="9" height="2" fill="#2f3640"/>
                        <text class="node-label" x="0" y="50" text-anchor="middle">Хост 6</text>
                    </g>
                </g>

                <!-- Подписи VLAN -->
                <g class="vlan-labels">
                    <text x="200" y="510" text-anchor="middle" fill="#2d3436">VLAN 10 - Отдел разработки</text>
                    <text x="500" y="510" text-anchor="middle" fill="#2d3436">VLAN 20 - Бухгалтерия</text>
                    <text x="800" y="510" text-anchor="middle" fill="#2d3436">VLAN 30 - Администрация</text>
                </g>
            </svg>
        </div>
    </div>

    <div class="info-panel" id="infoPanel">
        <button class="close-btn" onclick="closeInfo()">×</button>
        <h3>Активы</h3>
        <ul>
            <li>Компьютер 1</li>
            <li>Компьютер 2</li>
            <li>Компьютер 3</li>
        </ul>
    </div>

    <script>
        const map = document.getElementById('map');
        const mapWrapper = document.querySelector('.map-wrapper');
        let isDragging = false;
        let currentX;
        let currentY;
        let initialX;
        let initialY;
        let xOffset = 0;
        let yOffset = 0;
        let scale = 1;

        function setTransform() {
            map.style.transform = `translate(${currentX}px, ${currentY}px) scale(${scale})`;
        }

        function dragStart(e) {
            if (e.type === "touchstart") {
                initialX = e.touches[0].clientX - xOffset;
                initialY = e.touches[0].clientY - yOffset;
            } else {
                initialX = e.clientX - xOffset;
                initialY = e.clientY - yOffset;
            }
            isDragging = true;
        }

        function drag(e) {
            if (isDragging) {
                e.preventDefault();

                if (e.type === "touchmove") {
                    currentX = e.touches[0].clientX - initialX;
                    currentY = e.touches[0].clientY - initialY;
                } else {
                    currentX = e.clientX - initialX;
                    currentY = e.clientY - initialY;
                }

                xOffset = currentX;
                yOffset = currentY;

                setTransform();
            }
        }

        function dragEnd() {
            isDragging = false;
        }

        function zoom(factor) {
            scale *= factor;
            scale = Math.min(Math.max(0.5, scale), 3);
            setTransform();
        }

        // Обработчики для десктопа
        mapWrapper.addEventListener('mousedown', dragStart);
        document.addEventListener('mousemove', drag);
        document.addEventListener('mouseup', dragEnd);

        // Обработчики для мобильных устройств
        mapWrapper.addEventListener('touchstart', dragStart);
        document.addEventListener('touchmove', drag);
        document.addEventListener('touchend', dragEnd);

        // Обработчик для блока активов
        const assetsContainer = document.querySelector('.assets-container');
        const assetsList = document.querySelector('.assets-list');
        
        assetsContainer.addEventListener('click', (e) => {
            e.stopPropagation(); // Предотвращаем всплытие события
            assetsList.classList.toggle('active');
        });

        // Закрываем список при клике вне его
        document.addEventListener('click', (e) => {
            if (!assetsContainer.contains(e.target)) {
                assetsList.classList.remove('active');
            }
        });

        // Обработчики для блоков сервисов
        const servicesContainers = document.querySelectorAll('.services-container');
        const servicesLists = document.querySelectorAll('.services-list');
        
        servicesContainers.forEach((container, index) => {
            container.addEventListener('click', (e) => {
                e.stopPropagation();
                servicesLists[index].classList.toggle('active');
                
                // Закрываем все остальные списки сервисов
                servicesLists.forEach((list, i) => {
                    if (i !== index) {
                        list.classList.remove('active');
                    }
                });
            });
        });

        // Закрываем все списки при клике вне их
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.services-container') && !e.target.closest('.assets-container')) {
                servicesLists.forEach(list => list.classList.remove('active'));
                assetsList.classList.remove('active');
            }
        });
    </script>
</body>
</html>
